<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Torque Runtime Reference - Relevant classes and Resources - Torque</title><style type="text/css" media="all">
          @import url("../style/maven-base.css");
          
          @import url("../style/maven-theme.css");</style><link rel="stylesheet" href="../style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="Leon Messerschmidt"></meta><meta name="email" content="leon@opticode.co.za"></meta><meta name="author" content="Jason van Zyl"></meta><meta name="email" content="jvanzyl@periapt.com"></meta><meta name="author" content="Scott Eade"></meta><meta name="email" content="seade@backstagetech.com.au"></meta></head><body class="composite"><div id="banner"><a href="http://db.apache.org/" id="organizationLogo"><img alt="Apache Software Foundation" src="../images/db-logo-white.png"></img></a><a href="http://db.apache.org/torque/releases/torque-3.3/runtime/" id="projectLogo"><img alt="Torque" src="../images/torque-logo-new.png"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 28 February 2008
                <span class="separator">|</span> Doc for  3.3
                </div><div class="xright"></div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menuTorque"><h5>Torque</h5><ul><li class="none"><a href="../../../../index.html">Overview</a></li><li class="none"><a href="../../../../status.html">News and Status</a></li><li class="none"><a href="../../../../download.html">Downloads</a></li><li class="none"><a href="../../../../addons.html">Addons</a></li><li class="none"><a href="../../../../changes-report.html">Changes</a></li><li class="none"><a href="http://wiki.apache.org/db-torque/" class="externalLink" title="External Link">Wiki</a></li><li class="none"><a href="../../../../issue-tracking.html">Issue tracker</a></li><li class="none"><a href="../../../../mail-lists.html">Mailing lists</a></li><li class="none"><a href="../../../../tools/index.html">Tools</a></li><li class="collapsed"><a href="../../../../developer-info/index.html">Developer Information</a></li></ul></div><div id="menuModule_Documentation"><h5>Module Documentation</h5><ul><li class="none"><a href="../../../../documentation/index.html">Overview</a></li><li class="expanded"><a href="../../../../documentation/torque-3.3.html">Torque 3.3</a><ul><li class="collapsed"><a href="../../generator/index.html">Generator</a></li><li class="collapsed"><a href="../../maven-plugin/index.html">Maven 1 Plugin</a></li><li class="none"><a href="../../maven2-plugin/index.html" class="newWindow" title="New Window" target="_blank">Maven 2 Plugin</a></li><li class="expanded"><a href="../index.html">Runtime</a><ul><li class="expanded"><a href="../reference/index.html">Reference</a><ul><li class="none"><a href="../reference/initialisation-configuration.html">Initialisation</a></li><li class="none"><a href="../reference/read-from-db.html">Reading from the DB</a></li><li class="none"><a href="../reference/write-to-db.html">Writing to the DB</a></li><li class="none"><a href="../reference/extend-classes.html">Extending classes</a></li><li class="none"><a href="../reference/connections-transactions.html">Connections</a></li><li class="none"><a href="../reference/managers-cache.html">Managers and Cache</a></li><li class="none"><a href="../reference/beans.html">Beans</a></li><li class="none"><strong><a href="../reference/relevant-classes.html">Relevant classes</a></strong></li><li class="none"><a href="../reference/new-database-support.html">Supporting a new DB</a></li></ul></li><li class="none"><a href="../dependencies.html">Dependencies</a></li><li class="collapsed"><a href="../maven-reports.html">Project Reports</a></li></ul></li><li class="collapsed"><a href="../../tutorial/index.html">Tutorial</a></li><li class="collapsed"><a href="../../village/index.html">Village</a></li></ul></li><li class="collapsed"><a href="../../../../documentation/previous-releases.html">Previous releases</a></li></ul></div><div id="menuOther_Documentation"><h5>Other Documentation</h5><ul><li class="none"><a href="../../../../version-specific/supported-databases.html">Supported Databases</a></li><li class="collapsed"><a href="../../../../version-specific/database-howtos/index.html">Database Howtos</a></li><li class="collapsed"><a href="../../../../version-specific/other-howtos/index.html">Other Howtos</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="collapsed"><a href="../../../../project-info.html">Project info</a></li><li class="collapsed"><a href="../../../../project-reports.html">Site Project Reports</a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="../images/logos/maven-button-1.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Peers"></a><h2>Peers</h2>
    <p>
      Everything in Peers resolve around Peer classes.  A Peer class has a
      one-to-one mapping to a Database table.  You use each table's associated
      Peer class to do operations on that table.  Peer classes are generated
      for you automatically.
    </p>

    <p>
      Peer classes have static methods only, so you would never create objects 
      of Peer classes.  It is not necessary to have objects on this level 
      because of the one-to-one mapping with a table.  Peer methods are thread
      safe.
    </p>
     
    <p>
      Peer classes are generated for you automatically. For each table, two 
      Peer classes are generated: Base&lt;table-name&gt;Peer and 
      &lt;table-name&gt;Peer. The Base&lt;table-name&gt;Peer class contains 
      all the functionality and should not be changed. The other class is 
      empty but can be extended to add or change functionality. If you 
      regenerate with torque only the Base* class changes. This allows you 
      to change the schema, but still keep your existing code.
    </p>

  </div><div class="section"><a name="Data_Objects"></a><h2>Data Objects</h2>

    <p>
      A Data Object holds information about a single row of a specific table.
      Data Objects can be generated automatically for you.  It takes the form
      of Bean properties for each field of the table.
    </p>

    <p>
      The Data Object classes also generated automatically. For each table, two 
      Data Object classes are generated: Base&lt;table-name&gt; and 
      &lt;table-name&gt;.  As with the Peers, the Base&lt;table-name&gt; class
      contains all the functionality and should not be changed. The other class 
      is empty but can be extended to add or change functionality.  If you 
      regenerate the classes, only the Base* classes will be overwritten. 
    </p>

    <p>
      Data Objects are used almost exclusively with their related Peer classes.
      Where peer classes "wrap around" around a database table, a Data Object
      "wrap around" individual rows of the table.  The two always go together.
    </p>

    <p>
      You normally use Data Objects in one of two ways.  The most common way
      is to extract data after you called a doSelect on a Peer class.  The
      doSelect method returns a List of Data Objects that holds the data of
      the resultset.  Secondly you can create Data Objects and call their save
      methods to insert or update the related row into the database.
    </p>

  </div><div class="section"><a name="Criteria"></a><h2>Criteria</h2>

    <p>
      Criteria is an abstraction of the criteria of an sql query.  We use
      criteria objects to specify the criteria of a sql statement.  The
      database adaptor classes contains information on how this Criteria object
      will be translated to different flavours of sql.
    </p>

    <p>
      Criteria is in effect a map of field names and values that forms the
      criteria of a query.  By default the comparison  is equals (=) but you
      can define any comparison operator (&lt;, &gt;, &lt;=, &gt; =, IN, etc.).
    </p>

    <p>
      Criteria can also be used to do some other sql function like ORDER BY or
      DISTINCT.  If Criteria is too limited for your purposes (which should not
      happen often) you are still free to use raw sql queries.
    </p>

  </div><div class="section"><a name="Database_Maps"></a><h2>Database Maps</h2>

    <p>
      The Peers make use of a DatabaseMap class that holds internal data about
      the relational schema.  You will seldom, if ever, need to work with the
      DatabaseMap class.  It is used internally by Peers to discover information
      about the database at runtime.
    </p>

    <p>
      There is exactly one DatabaseMap for each relational database that you
      connect to.  You may wish to connect to more than one database in your
      application.  You should then have one DatabaseMap for each of the
      databases.
    </p>

    <p>
      DatabaseMaps are constructed by classes called MapBuilders.  Torque
      generates MapBuilder classes for each of the tables in your schema.
      The MapBuilder for a table  is called when the Peer class for the table
      is loaded.
    </p>
    
    <p>
      All DatabaseMaps are instances of the class 
      <code>org.apache.torque.map.DatabaseMap</code>.
      They are kept in the instance variable <code>TorqueInstance.dbMaps</code>.
      The Map for the database with the name key can be retrieved
      by the method Torque.getDatabaseMap(key).
    </p>

  </div><div class="section"><a name="ID_Broker"></a><h2>ID Broker</h2>

    <p>
      The ID Broker is used to automatically create unique primary keys for 
      tables.  It creates id's from a database table called id_table.
    </p>

    <p>
      Of course Torque also supports using the ID generation provided by the
      underlying database system - just set the <code>idMethod</code> attributes
      as desired in your schema.
    </p>

    <p>
      The ID Broker is used in the underlying Peer code.  After you have 
      generated your object model classes you need not worry about it anymore.
    </p>

  </div><div class="section"><a name="Database_adaptors"></a><h2>Database adaptors</h2>

    <p>
      Although all databases supported by Torque understand SQL, there are
      differences in the behaviour of the databases which the Torque runtime
      needs to know about. For example, the standard (String) format
      of a date object in an Oracle9i database is different from a
      postgresql database.
      The adapter for a database provides the necessary methods to hide such
      differences from the user.
      For example, the adapter provides a method to create a String in the
      database's preferred format from a Date object.
    </p>

    <p>
      Adapters are subclasses of the <code>org.apache.torque.adapter.DB</code>
      class.
      The adapters are stored in the private map TorqueInstance.apdapterMap;
      the key of the map is the name of the database (e.g. "bookstore"),
      and the value of the map is the adapter. The adapter for a given key
      can be retrieved via the method Torque.getDB(key).
    </p>

    <p>
      If your database is not yet supported, you can read the 
      <a href="new-database-support.html">Support for new Databases</a> 
      docs on how to create a new adapter for your database.
    </p>

  <div class="section"><a name="DataSourceFactories"></a><h2>DataSourceFactories</h2>
    <p>
      To access a database, a connection must be made to the database.
      A DataSource is an object which can provide Connections to the 
      database.  A DataSourceFactory is used to configure and provide
      one DataSource.
    </p>

    <p>
      All DataSourceFactories used by Torque must implement the interface
      <code>org.apache.torque.dsfactory.DataSourceFactory</code>.
      The DataSourceFactories are stored in the private map
      <code>TorqueInstance.dsFactoryMap</code>; the key of the map is the
      name of the database (e.g. "bookstore"), and the
      value of the map is the DataSourceFactory.
      The DataSourceFactory for a given key can not be retrieved 
      by a public method; however, a connection from the DataSource
      for the DataSourceFactory for a given key can be obtained 
      by Torque.getConnection(key);
    </p>
  </div>

    
  </div><div class="section"><a name="Internal_resources_used_by_the_Torque_Runtime"></a><h2>Internal resources used by the Torque Runtime</h2>

    <div class="subsection"><a name="Default_database_name"></a><h3>Default database name</h3>

      <p>
        Torque can be used with several databases at once.
        The resources for each database are usually kept in Maps
        where the key is the name of the database.  To make things easier
        for people who use only one database, Torque supports the notion
        of a default database. This allows it to provide convenience
        methods like <code>Torque.getConnection()</code> where no database name 
        must be specified.  These methods refer to the default database,
        in contrast to e.g. <code>Torque.getConnection(String)</code>
        where the name of the database must be supplied explicitly.
      </p>
      
      <p>
        The name of the default database can be retrieved by 
        <code>Torque.getDefaultDB()</code>.
      </p>

    </div>

  </div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2000-2008, Apache Software Foundation</div><div class="clear"><hr></hr></div></div></body></html>